<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>Document</title>
  <style>
    * {
      margin: 0;
      padding: 0;
    }

    .item {
      display: flex;
      justify-content: center;
      align-items: center;
      margin-right: 15px;
      margin-bottom: 15px;
      width: 200px;
      position: absolute;
    }

    .item img {
      width: 200px;
    }
  </style>
</head>

<body>
  <div>
    <div class="item">
      <img src="./images/1.jpg" alt="1">
    </div>
    <div class="item">
      <img src="./images/2.jpg" alt="2">
    </div>
    <div class="item">
      <img src="./images/3.jpg" alt="3">
    </div>
    <div class="item">
      <img src="./images/4.jpg" alt="4">
    </div>
    <div class="item">
      <img src="./images/5.jpg" alt="5">
    </div>
    <div class="item">
      <img src="./images/6.jpg" alt="6">
    </div>
    <div class="item">
      <img src="./images/7.jpg" alt="7">
    </div>
    <div class="item">
      <img src="./images/8.jpg" alt="8">
    </div>
    <div class="item">
      <img src="./images/9.jpg" alt="9">
    </div>
    <div class="item">
      <img src="./images/10.jpg" alt="10">
    </div>
    <div class="item">
      <img src="./images/11.jpg" alt="11">
    </div>
    <div class="item">
      <img src="./images/12.jpg" alt="12">
    </div>
    <div class="item">
      <img src="./images/13.jpg" alt="13">
    </div>
    <div class="item">
      <img src="./images/14.jpg" alt="14">
    </div>
  </div>
  <script>
    let items = document.getElementsByClassName('item');
    //定义间隙10像素
    let gap = 10;
    window.onload = () => waterFall();

    function waterFall() {
      //首先确定列数 = 页面的宽度 / 图片的宽度
      let pageWidth = getClient().width;
      let itemWidth = items[0].offsetWidth;
      let columns = parseInt(pageWidth / (itemWidth + gap));
      let arr = [];//定义一个数组，用来存储元素的高度
      let len = items.length;
      for (let i = 0; i < len; i++) {
        if (i < columns) {
          //满足这个条件则说明在第一行
          items[i].style.top = 0;
          items[i].style.left = (itemWidth + gap) * i + 'px';
          arr.push(items[i].offsetHeight);
        } else {
          //其他行，先找出最小高度列，和索引
          //假设最小高度是第一个元素
          let minHeight = arr[0];
          let index = 0;
          let len = arr.length;
          for (let j = 0; j < len; j++) {//找出最小高度
            if (minHeight > arr[j]) {
              minHeight = arr[j];
              index = j;
            }
          }
          //设置下一行的第一个盒子的位置
          //top值就是最小列的高度+gap
          items[i].style.top = arr[index] + gap + 'px';
          items[i].style.left = items[index].offsetLeft + 'px';

          //修改最小列的高度
          //最小列的高度 = 当前自己的高度 + 拼接过来的高度 + 间隙的高度
          arr[index] = arr[index] + items[i].offsetHeight + gap;
        }
      }
    }

    //当页面尺寸发生变化时，触发函数，实现响应式
    window.onresize = () => waterFall();

    // clientWidth 处理兼容性
    function getClient() {
      return {
        width: window.innerWidth || document.documentElement.clientWidth || document.body.clientWidth,
        height: window.innerHeight || document.documentElement.clientHeight || document.body.clientHeight
      }
    }
    // scrollTop兼容性处理
    function getScrollTop() {
      return window.pageYOffset || document.documentElement.scrollTop;
    }
  </script>
</body>

</html>